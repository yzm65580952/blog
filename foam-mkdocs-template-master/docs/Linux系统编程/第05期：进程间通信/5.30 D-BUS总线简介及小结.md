# 5.30 D-BUS总线简介及小结
## 什么是D-BUS？
1. 针对桌面环境，用于本地进程间通信的一种IPC机制
2. 主要用于同一桌面会话中，不同桌面应用程序之间的通信
3. 同时支持桌面会话与操作系统之间的通信
4. 系统总线：system bus，用于内核和应用进程之间的通信和消息传递
5. 会话总线：session bus，用于桌面(GNOME/KDE等)用户进程之间的通信。D-BUS一般由一个系统总线和几个会话总线构成
6. 总线权限：只有Linux内核、Linux桌面环境和权限较高的应用进程才有权限向系统总线写入消息，安全性高

 ## D-BUS组成
1. Libdbus
– 点对点的通信支持库，提供C语言API
– 不同进程可引用库的API进行通信
2. dbus daemon
– D-BUS服务进程，基于libdbus，作用类似于总线
– 不同进程可以通过API连接它，发送和接收消息
– 支持一对一、一对多的通信
3. 基于libdbus的封装库或框架：
– Libdbus-glib、libdbus-qt
– 通过dbus binding，支持多种语言：C/C++、Java/Python、Perl、Ruby…
– 只要应用程序兼容dbus通信协议，可以支持任何语言

## 对象
1. 每个使用D-BUS的进程都包括一组对象，消息发送到或者发送自某一个对象，这些对象由对象路径唯一标识
2. D-BUS本质上是一个对等(p2p)协议：每个消息都有一个源和目的，这些地址被称为对象路径
3. 每个对象支持一个或多个接口，一个接口是多个方法和信号的集合

## D-BUS在PC桌面环境中的应用
1. 给Linux桌面环境(GNOME、KDE等)提供的服务标准化
2. Android中的Dbus
3. Qt中的Dbus
4. 越多越多的GUI开始支持/兼容Dbus…
5. 例：Ubuntu16.04桌面环境
– Systemd—lightdm—upstart
» Dbus-daemon
» Dcanf-service
» Gnome-session-b
» Gnome-terminal-bash-su

## 各种工具的比较
1. 无名管道：只能用于亲缘进程通信
2. 有名管道：可用于任意两进程间通信，但只能传输流数据、缓冲区大小受限
3. 消息队列：可以传输有格式字节流，但是效率低：系统调用产生的用
户空间、内核空间转换的开销
4. 共享内存：通信效率最高最快，解决了进程间通信运行效率低等开销问题，但是可能会带来同步问题
5. 信号量：用来不同进程、线程之间的同步，与共享内存结合使用
6. 文件锁：可以对整个文件、或者文件的一部分区域进行加锁
7. 信号：唯一的异步通信、但是存在一系列的问题
8. Linux特有API：将异步通信操作转换为I/O操作
5. Dbus：桌面进程之间的通信
9. 套接字：适用于不同机器进程间的通信，目前应用最广泛的

