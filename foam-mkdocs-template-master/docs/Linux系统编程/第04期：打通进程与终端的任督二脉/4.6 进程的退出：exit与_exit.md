# 4.6 进程的退出：exit与_exit
## exit是库函数是对_exit系统调用的封装
 在调用_exit之前，它会执行各种动作
– 调用退出处理程序(通过atexit和on_exit注册的回调函数)
– 刷新stdio流缓冲区
– 使用由status提供的值执行_exit系统调用

## _exit和_Exit执行流程
1. 关闭进程打开的文件描述符、释放该进程持有的文件锁
2. 关闭该进程打开的信号量、消息队列
3. 取消该进程通过mmap()创建的内存映射
4. 将该进程的所有子进程交给init托管
5. 给父进程发送一个SIGCHLD信号

## 关于_exit和exit总结
1. 在一个进程中，直接调用_exit终止进程，缓冲区的数据可能会丢失
2. 在创建子进程的应用中，只应有一个进程(一般为父进程)调用exit终止，而<font color=red>其他进程应调用_exit()终止。从而确保只有一个进程调用退出处理程序并刷新stdio缓冲区</font>
3. 如果一个进程使用atexit/on_exit注册了退出管理程序，则应使用exit终止程序的运行，否则注册的回调函数无法执行


## 终止进程的各种方法
1. 从main函数return
2. 调用库函数：exit
3. 调用系统调用：_exit/_Exit
4. 调用abort：_exit的内部实现(POSIX)
5. 信号：Ctrl+C
