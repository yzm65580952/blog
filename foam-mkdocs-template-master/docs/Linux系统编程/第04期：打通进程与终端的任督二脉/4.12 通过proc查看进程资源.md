# 4.12 通过proc查看进程资源
## 进程结构体 task_struct
```c
struct task_struct {
void *stack;
atomic_t usage;
const struct sched_ class *sched_class;
struct list_head  tasks;
struct  mm_struct *mm, *active_mm;
struct  vm_area_struct *vmacache[VMACACHE_SIZE];
int exit_state;
pid_t pid;
pid_t  tgid;
struct  task_struct *parent;
struct list_head children; 
struct fs_struct *fs;
struct files_struct *files;
struct bio_list *bio_list;
struct reclaim_state *reclaim_state;
...
int pagefault_disabled;
struct thread_struct thread;
}
```
## ps命令
-A/-e：显示系统所有的进程(包括守护进程)，相当于-e
-a：显示所有终端下的所有用户运行的进程
-u：显示用户名、CPU百分比和内存的使用
-x/-f：列出进程的详细信息
-H：显示进程树
-r：只显示正在运行的进程
-o：分类输出
$ ps –o pid,ppid,state,tty,command
监视进程：$ top
## procfs文件系统
1. Linux内核：一切皆文件，ps命令也是从proc文件读取数据
2. Procfs是Linux内核中一个特殊的文件系统，以/proc目录形式呈现
3. 应用程序可通过/proc下的文件接口对驱动和内核信息进行访问
– 获取内核信息、硬件设备信息、进程信息
– 设置内核参数、控制开关
## 通过proc查看进程资源
进程对应的可执行文件名字
环境变量、CPU、内存相关信息
进程的上下文环境、堆栈
进程状态
进程打开的文件列表

文件 | 说明
:-|:-
cmdline |  以\0分割的命令行参数
cmd |  指向当前工作目录的符号链接
environ |  NAME=value键值对环境列表，以\0分隔
exe |  指向正在执行文件的符号链接
fd |  文件目录
maps |  内存映射
mem  | 进程虚拟内存
mounts |  进程的安装点
root  | 指向根目录的符号链接
status |  进程的各种信息：PID、内存使用量、信号
task  | 进程中的每个线程均包含一个子目录