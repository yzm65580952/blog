## 8.13 Linux中的定时器：POSIX timer(下)

## 定时器到期后新开一个线程
```c
#include <stdlib.h>
#include <unistd.h>
#include <stdio.h>
#include <signal.h>
#include <time.h>
#include <string.h>

void timer_thread(union sigval val)
{
    printf("catch args:%d\n", val.sival_int);
}
     
int main(void)
{
    timer_t timerid;
    struct sigevent sev;
    memset (&sev, 0, sizeof (struct sigevent));
    
	//1.初始化sigevent变量
    sev.sigev_notify = SIGEV_THREAD;//通知类型SIGEV_THREAD开辟线程
    sev.sigev_notify_function = timer_thread;//线程函数
    sev.sigev_value.sival_int = 3;//通过联合体给线程传参数
	
	//2.创建定时器，CLOCK_REALTIME实时计时
    if (timer_create(CLOCK_REALTIME, &sev, &timerid) == -1)
    {
    	perror ("timer_create");
    	exit (EXIT_FAILURE);
    }
	
    //3.初始化初始化itimerspec变量
    struct itimerspec its;
    its.it_value.tv_sec = 5;
    its.it_value.tv_nsec = 0;
    its.it_interval.tv_sec = 1;
    its.it_interval.tv_nsec = 0;
	
	//4.启动定时器
    if (timer_settime(timerid, 0, &its, NULL) == -1)
    {
    	perror ("timer_settime");
    	exit (EXIT_FAILURE);
    }

	while (1);
	
	//5.删除定时器
    timer_delete (timerid);
    exit(EXIT_SUCCESS);
}


```