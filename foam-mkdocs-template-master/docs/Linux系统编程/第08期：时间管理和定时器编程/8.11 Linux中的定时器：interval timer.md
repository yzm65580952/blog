# 8.11 Linux中的定时器：interval timer

## interval timer，共享相同的定时器
• 定时器到期，发送信号到当前进程【定时器精度：微秒级】
• int getitimer (int which, struct itimerval *curr_value);
• int setitimer (int which, const struct itimerval *new_value,
struct itimerval *old_value);

### wich 
定时器计时类型
ITIMER_REAL：实时计时，到期后发送SIGALRM信号到进程
ITIMER_VIRTUAL：进程用户态运行才计时，到期发送SIGVTALRM信号
ITIMER_PROF：进程在用户和内核空间都计时，到期发送SIGPROF信号

### itimerval
```c
struct itimerval
{
struct timeval it_interval;
/*定时器的周期 Interval for periodic timer */
struct timeval it_value; 
/*等待启动的时间 Time until next expiration */
};
struct timeval
{
time_t tv_sec; /* seconds */
suseconds_t tv_usec; /* microseconds */
};
```

## demo 
```c
#include <stdio.h>
#include <sys/time.h>
#include <signal.h>
#include <errno.h>
#include <unistd.h>

void signal_handler (int signo)
{
    printf ("Catch signal: %d\n", signo);
}

int main (void)
{
    struct itimerval tv, tv_prev;
    signal (SIGALRM, signal_handler);//1.注册信号接收函数
    
    tv.it_value.tv_sec = 5;//2.setitimer
    tv.it_value.tv_usec = 0;
    tv.it_interval.tv_sec = 1;
    tv.it_interval.tv_usec = 0;
    if (setitimer (ITIMER_REAL, &tv, &tv_prev) != 0)
    {
        printf ("setitimer error %d\n", errno);
        return -1;
    }
    while (1);
    return 0;
}

```