# 7.7 线程的调度与运行
##  线程分类
1. 核心级线程
由内核调度，有利于并发使用多处理器资源
2. 用户级线程
由用户层调度，减少上下文切换开销
3. 线程模型
一对一模型
多对一模型
多对多模型

## 一对一模型
用户线程通过LWP关联内核线程
线程调度由内核完成
SMP、并发使用CPU资源
线程间同步由用户层完成
Linux、Windows家族(XP之前)

## 多对一模型
多个用户线程与一个内核线程关联
线程管理由用户完成、CPU仍以进程为调度单位
单处理器
Solaris线程库：Green thread
## 多对多模型
内核线程为CPU调度单元
用户线程管理

## Linux下的线程(一对一线程模型)
1. 一个轻量进程(LWP)对应一个线程，
2. 每个LWP都与一个内核线程关联
3. 内核线程，通过LWP绑定，调度用户线程
4. 内核线程被阻塞，LWP也阻塞，用户线程也阻塞
5. 调度由内核完成
– SCHED_OTHER：分时调度策略
– SCHED_FIFO：实时调度策略：FIFO
– SCHED_RR：实时调度策略：时间片轮转
6. 创建线程、同步等API由用户线程库完成
– Linuxthreads：线程PID、信号处理存在不足
– NPTL(Native POSIX Thread Library)

## LWP(轻量级进程)与普通用户进程比较
1. LWP只有一个最小的执行上下文和调度程序需要的统计信息
2. 用户进程有独立地址空间，LWP与父进程共享地址空间
3. LWP可以像内核线程一样，全局范围内竞争处理器资源
4. LWP调度可以跟用户进程、内核线程一样调度
5. 每一个用户进程可能有一个或多个LWP
6. 通过clone，各进程共享地址空间和资源
– CLONE_VM、 CLONE_FS
– CLONE_FILES、CLONE_SIGHAND
7. $ top -H -p <pid>
8. 查看某个指定PID进程下的线程运行
	